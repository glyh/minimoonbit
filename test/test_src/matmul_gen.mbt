
fn matshow(m: Int, n: Int, mat: Array[Array[Double]]) -> Unit {
  fn loop1(i: Int) -> Unit {
    if i <= m - 1 {
      fn loop2(j: Int) -> Unit {
        if j <= n - 1 {
          let _ = print_int(truncate(mat[i][j]));
          let _ = print_char(32);
          loop2(j+1)
        } else {
          print_endline()
        }
      }; 
      let _ = loop2(0);
      loop1(i+1)
    } else {
      ()
    }
  }; 
  loop1(0)
};

fn matmul(l: Int, m: Int, n: Int, a: Array[Array[Double]], b: Array[Array[Double]], c: Array[Array[Double]]) -> Unit {
  fn loop1(i: Int) -> Unit {
    if 0 <= i {
      fn loop2(j: Int) -> Unit {
        if 0 <= j {
          fn loop3(k: Int) -> Unit {
            if 0 <= k {
              c[i][j] = c[i][j] + a[i][k] * b[k][j];
              loop3(k - 1)
            } else {
              ()
            }
          };
          let _ = loop3(m - 1);
          loop2(j - 1)
        } else {
          ()
        }
      };
      let _ = loop2(n - 1);
      loop1(i - 1)
    } else {
      ()
    }
  };
  loop1(l - 1)
};

fn main {
  let dummy = Array::make(0, 0.0);
  fn gen_arr(m: Int, n: Int) -> Array[Array[Double]] {
    let mat = Array::make(m, dummy);
    fn init_arr(i: Int) -> Unit {
      if 0 <= i {
        mat[i] = Array::make(n, 0.0);
        init_arr(i - 1)
      } else {
        ()
      }
    };
    let _ = init_arr(m - 1);
    mat
  };

  let a = gen_arr(10, 10);
  let b = gen_arr(10, 10);
  let c = gen_arr(10, 10);

  a[0][0] = 6.31; a[0][1] = 7.15; a[0][2] = 7.98; a[0][3] = 6.0; a[0][4] = 5.97; a[0][5] = 6.64; a[0][6] = 8.35; a[0][7] = 8.73; a[0][8] = 2.27; a[0][9] = 4.85;
  a[1][0] = 8.03; a[1][1] = 2.96; a[1][2] = 5.47; a[1][3] = 2.95; a[1][4] = 9.4; a[1][5] = 6.64; a[1][6] = 0.7; a[1][7] = 2.87; a[1][8] = 5.56; a[1][9] = 9.94;
  a[2][0] = 2.94; a[2][1] = 7.27; a[2][2] = 8.14; a[2][3] = 8.42; a[2][4] = 3.82; a[2][5] = 9.53; a[2][6] = 7.19; a[2][7] = 2.6; a[2][8] = 3.39; a[2][9] = 2.6;
  a[3][0] = 1.04; a[3][1] = 1.34; a[3][2] = 9.74; a[3][3] = 6.77; a[3][4] = 3.73; a[3][5] = 4.77; a[3][6] = 4.71; a[3][7] = 7.22; a[3][8] = 6.39; a[3][9] = 9.43;
  a[4][0] = 8.74; a[4][1] = 3.57; a[4][2] = 2.89; a[4][3] = 9.43; a[4][4] = 6.62; a[4][5] = 9.37; a[4][6] = 2.04; a[4][7] = 2.07; a[4][8] = 7.97; a[4][9] = 6.7;
  a[5][0] = 8.65; a[5][1] = 6.86; a[5][2] = 5.11; a[5][3] = 6.66; a[5][4] = 1.59; a[5][5] = 2.54; a[5][6] = 9.67; a[5][7] = 0.32; a[5][8] = 2.83; a[5][9] = 9.32;
  a[6][0] = 3.88; a[6][1] = 1.13; a[6][2] = 4.18; a[6][3] = 7.37; a[6][4] = 1.26; a[6][5] = 2.89; a[6][6] = 1.56; a[6][7] = 7.53; a[6][8] = 9.79; a[6][9] = 0.84;
  a[7][0] = 9.31; a[7][1] = 9.95; a[7][2] = 2.23; a[7][3] = 2.76; a[7][4] = 2.6; a[7][5] = 1.96; a[7][6] = 9.16; a[7][7] = 0.87; a[7][8] = 3.59; a[7][9] = 5.92;
  a[8][0] = 7.85; a[8][1] = 9.66; a[8][2] = 2.9; a[8][3] = 4.67; a[8][4] = 5.05; a[8][5] = 1.36; a[8][6] = 7.63; a[8][7] = 10.0; a[8][8] = 7.09; a[8][9] = 7.7;
  a[9][0] = 1.67; a[9][1] = 8.16; a[9][2] = 4.85; a[9][3] = 9.2; a[9][4] = 7.42; a[9][5] = 6.94; a[9][6] = 5.88; a[9][7] = 7.84; a[9][8] = 2.55; a[9][9] = 3.77;

  b[0][0] = 2.02; b[0][1] = 7.28; b[0][2] = 1.17; b[0][3] = 7.19; b[0][4] = 3.7; b[0][5] = 5.99; b[0][6] = 9.42; b[0][7] = 8.49; b[0][8] = 7.97; b[0][9] = 8.95;
  b[1][0] = 8.18; b[1][1] = 4.6; b[1][2] = 4.47; b[1][3] = 1.45; b[1][4] = 3.6; b[1][5] = 9.14; b[1][6] = 6.36; b[1][7] = 5.98; b[1][8] = 9.16; b[1][9] = 2.4;
  b[2][0] = 5.72; b[2][1] = 1.34; b[2][2] = 5.94; b[2][3] = 5.4; b[2][4] = 8.43; b[2][5] = 4.75; b[2][6] = 0.65; b[2][7] = 3.19; b[2][8] = 3.51; b[2][9] = 2.16;
  b[3][0] = 6.69; b[3][1] = 6.1; b[3][2] = 5.43; b[3][3] = 8.81; b[3][4] = 8.12; b[3][5] = 8.02; b[3][6] = 9.91; b[3][7] = 0.88; b[3][8] = 0.06; b[3][9] = 3.12;
  b[4][0] = 2.19; b[4][1] = 1.89; b[4][2] = 6.85; b[4][3] = 8.73; b[4][4] = 2.11; b[4][5] = 4.48; b[4][6] = 7.25; b[4][7] = 2.83; b[4][8] = 8.08; b[4][9] = 0.63;
  b[5][0] = 2.39; b[5][1] = 4.83; b[5][2] = 5.05; b[5][3] = 0.65; b[5][4] = 4.59; b[5][5] = 8.7; b[5][6] = 9.11; b[5][7] = 1.7; b[5][8] = 2.49; b[5][9] = 2.34;
  b[6][0] = 8.91; b[6][1] = 3.72; b[6][2] = 0.13; b[6][3] = 9.1; b[6][4] = 4.53; b[6][5] = 1.97; b[6][6] = 2.67; b[6][7] = 1.92; b[6][8] = 2.42; b[6][9] = 5.23;
  b[7][0] = 9.89; b[7][1] = 5.62; b[7][2] = 8.5; b[7][3] = 1.06; b[7][4] = 7.61; b[7][5] = 3.62; b[7][6] = 4.59; b[7][7] = 7.37; b[7][8] = 7.92; b[7][9] = 3.33;
  b[8][0] = 9.95; b[8][1] = 0.36; b[8][2] = 1.23; b[8][3] = 1.42; b[8][4] = 1.14; b[8][5] = 6.96; b[8][6] = 8.51; b[8][7] = 1.03; b[8][8] = 1.7; b[8][9] = 6.18;
  b[9][0] = 4.66; b[9][1] = 5.5; b[9][2] = 7.44; b[9][3] = 9.1; b[9][4] = 2.53; b[9][5] = 2.16; b[9][6] = 5.21; b[9][7] = 9.08; b[9][8] = 8.29; b[9][9] = 8.15;

  let _ = matmul(10,10,10,a,b,c);
  let _ = matshow(10, 10, a);
  let _ = print_endline();
  let _ = matshow(10, 10, b);
  let _ = print_endline();
  let _ = matshow(10, 10, c);
  ()

};